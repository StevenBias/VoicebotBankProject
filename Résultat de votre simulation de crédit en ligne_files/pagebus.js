window.OpenAjax||(OpenAjax=new function(){var e="org.openajax.hub.",t={};this.hub=t,t.implementer="http://openajax.org",t.implVersion="2.0",t.specVersion="2.0",t.implExtraData={};var r={};t.libraries=r,t.registerLibrary=function(t,i,s,n){r[t]={prefix:t,namespaceURI:i,version:s,extraData:n},this.publish(e+"registerLibrary",r[t])},t.unregisterLibrary=function(t){this.publish(e+"unregisterLibrary",r[t]),delete r[t]},t._subscriptions={c:{},s:[]},t._cleanup=[],t._subIndex=0,t._pubDepth=0,t.subscribe=function(e,t,r,i,s){r||(r=window);var n=e+"."+this._subIndex,c={scope:r,cb:t,fcb:s,data:i,sid:this._subIndex++,hdl:n},a=e.split(".");return this._subscribe(this._subscriptions,a,0,c),n},t.publish=function(e,t){var r=e.split(".");if(this._pubDepth++,this._publish(this._subscriptions,r,0,e,t),this._pubDepth--,this._cleanup.length>0&&0==this._pubDepth){for(var i=0;i<this._cleanup.length;i++)this.unsubscribe(this._cleanup[i].hdl);delete this._cleanup,this._cleanup=[]}},t.unsubscribe=function(e){var t=e.split("."),r=t.pop();this._unsubscribe(this._subscriptions,t,0,r)},t._subscribe=function(e,t,r,i){var s=t[r];r==t.length?e.s.push(i):(void 0===e.c&&(e.c={}),void 0===e.c[s]?(e.c[s]={c:{},s:[]},this._subscribe(e.c[s],t,r+1,i)):this._subscribe(e.c[s],t,r+1,i))},t._publish=function(e,t,r,i,s,n){if(void 0!==e){var c;if(r==t.length?c=e:(this._publish(e.c[t[r]],t,r+1,i,s,n),this._publish(e.c["*"],t,r+1,i,s,n),c=e.c["**"]),void 0!==c)for(var a=c.s,u=a.length,h=0;u>h;h++)if(a[h].cb){var o=a[h].scope,l=a[h].cb,p=a[h].fcb,f=a[h].data;"string"==typeof l&&(l=o[l]),"string"==typeof p&&(p=o[p]),(!p||p.call(o,i,s,f))&&l.call(o,i,s,f,n)}}},t._unsubscribe=function(e,t,r,i){if(void 0!==e){if(r<t.length){var s=e.c[t[r]];if(this._unsubscribe(s,t,r+1,i),0==s.s.length){for(var n in s.c)return;delete e.c[t[r]]}return}for(var c=e.s,a=c.length,u=0;a>u;u++)if(i==c[u].sid)return void(this._pubDepth>0?(c[u].cb=null,this._cleanup.push(c[u])):c.splice(u,1))}}},OpenAjax.hub.registerLibrary("OpenAjax","http://openajax.org/hub","1.0",{})),window.PageBus||(PageBus=new function(){var e=0,t=[],r=this;this.version="2.0.0",this._debug=function(){},_badParm=function(){throw Error("OpenAjax.hub.Errors.BadParameters")},_valPub=function(e){(null==e||-1!=e.indexOf("*")||-1!=e.indexOf("..")||"."==e.charAt(0)||"."==e.charAt(e.length-1))&&_badParm()},_valSub=function(e){for(var t=e.split("."),r=t.length,i=0;r>i;i++)(""==t[i]||-1!=t[i].indexOf("*")&&"*"!=t[i]&&"**"!=t[i])&&_badParm(),"**"==t[i]&&r-1>i&&_badParm();return t},_cacheIt=function(e){return e&&"object"==typeof e&&e.PageBus&&e.PageBus.cache},_TopicMatcher=function(){this._items={}},_TopicMatcher.prototype.store=function(e,t){var r=e.split("."),i=r.length;(_recurse=function(s,n){if(n==i)s["."]={topic:e,value:t};else{var c=r[n];s[c]||(s[c]={}),_recurse(s[c],n+1)}})(this._items,0)},_TopicMatcher.prototype.match=function(e,t){var r=e.split("."),i=r.length,s=[];return _recurse=function(e,n){if(e){var c;if(n==i)c=e;else{if(_recurse(e[r[n]],n+1),t)return;"**"!=r[n]&&_recurse(e["*"],n+1),c=e["**"]}c&&c["."]&&s.push(c["."])}},_recurse(this._items,0),s},_TopicMatcher.prototype.exists=function(e,t){var r=e.split("."),i=r.length,s=!1;return _recurse=function(e,n){if(e){var c;if(n==i)c=e;else{if(_recurse(e[r[n]],n+1),s||t)return;if("**"!=r[n]&&(_recurse(e["*"],n+1),s))return;c=e["**"]}c&&c["."]&&(s=!0)}},_recurse(this._items,0),s},_TopicMatcher.prototype.clear=function(e){var t=e.split("."),r=t.length;(_recurse=function(e,i){if(e)if(i==r)e["."]&&delete e["."];else{_recurse(e[t[i]],i+1);for(var s in e[t[i]])return;delete e[t[i]]}})(this._items,0)},_TopicMatcher.prototype.wildcardMatch=function(e){var t=e.split("."),r=t.length,i=[];return _recurse=function(e,s){var n,c=t[s];if(e&&s!=r)if("**"==c)for(var a in e)"."!=a&&(n=e[a],n["."]&&i.push(n["."]),_recurse(n,s));else if("*"==c)for(var a in e)"."!=a&&"**"!=a&&(n=e[a],s==r-1?n["."]&&i.push(n["."]):_recurse(n,s+1));else{if(n=e[c],!n)return;s==r-1?n["."]&&i.push(n["."]):_recurse(n,s+1)}},_recurse(this._items,0),i},this._refs={},this._doCache=new _TopicMatcher,this._caches=new _TopicMatcher,_isCaching=function(e){return r._doCache.exists(e,!1)},_copy=function(e){var t;if("object"==typeof e){if(null==e)return null;if(e.constructor==Array){t=[];for(var r=0;r<e.length;r++)t[r]=_copy(e[r]);return t}if(e.constructor==Date)return t=new Date,t.setDate(e.getDate()),t;t={};for(var i in e)t[i]=_copy(e[i]);return t}return e},this._add=function(e,t){var r,i=this._doCache.match(e,!0);i.length>0?r=i[0].value:(r={rc:0},this._doCache.store(e,r)),r.rc++,this._refs[t]=e},this._remove=function(e){var t=this._refs[e];if(t){delete this._refs[e];var r=this._doCache.match(t,!0);if(0!=r.length&&(r[0].value.rc--,0==r[0].value.rc)){this._doCache.clear(t);for(var i=this._caches.wildcardMatch(t),s=0;s<i.length;s++)this._doCache.exists(i[s].topic,!1)||this._caches.clear(i[s].topic)}}},this.subscribe=function(e,t,r,i){i||(i=null);var s=OpenAjax.hub.subscribe(e,r,t,i);if(_cacheIt(i)){this._add(e,s);for(var n=this.query(e),c=0;c<n.length;c++)try{r.call(t?t:window,n[c].topic,n[c].value,i)}catch(a){PageBus._debug()}}return s},this.publish=function(r,i){if(_valPub(r),t.push({n:r,m:i,d:e+1}),_isCaching(r))try{this._caches.store(r,i)}catch(s){_badParm()}if(0==e)for(;t.length>0;){{var n=t.shift();n.n.split(".")}try{e=n.d,OpenAjax.hub.publish(n.n,n.m),e=0}catch(c){throw e=0,c}}},this.unsubscribe=function(e){try{this._remove(e),OpenAjax.hub.unsubscribe(e)}catch(t){_badParm()}},this.store=function(e,t){if(!_isCaching(e))throw Error("PageBus.cache.NoCache");this.publish(e,t)},this.query=function(e){try{return _valSub(e),this._caches.wildcardMatch(e)}catch(t){_badParm()}}},OpenAjax.hub.registerLibrary("PageBus","http://tibco.com/PageBus","1.2.0",{}));